{{> header}}

<section class="card">
  <h2>
    Local Transactions on Node {{nodeId}} ({{nodeRole}})
  </h2>

  <p>
    These rows come from this node's own <code>trans</code> table.
    For the project:
  </p>
  <ul>
    <li>Node 1 (central) should show all Transaction Types: Credit, Debit (Withdrawal), VYBER.</li>
    <li>Node 2 should show only Transaction Type: Credit.</li>
    <li>Node 3 should show only Transaction Type: Debit (Withdrawal), VYBER.</li>
  </ul>

  <!-- pagination controls -->
  <div class="pagination-controls">
    <div class="page-size">
      <form method="get" action="/transactions/local">
        <label for="pageSize">
          Rows per page:
        </label>
        <select id="pageSize" name="pageSize" onchange="this.form.submit()">
          {{#each pageSizeOptions}}
            <option value="{{value}}" {{#if selected}}selected{{/if}}>{{value}}</option>
          {{/each}}
        </select>
        <!-- always reset to page 1 when changing page size -->
        <input type="hidden" name="page" value="1" />
      </form>
    </div>

    <div class="page-info">
      <span>
        Page <strong>{{page}}</strong> of <strong>{{totalPages}}</strong>
        &mdash;
        Showing <strong>{{startRow}}</strong>–<strong>{{endRow}}</strong>
        of <strong>{{totalCount}}</strong> rows
      </span>
    </div>

    <div class="page-nav">
      <a
        href="/transactions/local?page=1&pageSize={{pageSize}}"
        class="page-button {{#if isFirstPage}}disabled{{/if}}"
      >
        « First
      </a>

      <a
        href="/transactions/local?page={{prevPage}}&pageSize={{pageSize}}"
        class="page-button {{#if isFirstPage}}disabled{{/if}}"
      >
        ‹ Prev
      </a>

      <a
        href="/transactions/local?page={{nextPage}}&pageSize={{pageSize}}"
        class="page-button {{#if isLastPage}}disabled{{/if}}"
      >
        Next ›
      </a>

      <a
        href="/transactions/local?page={{totalPages}}&pageSize={{pageSize}}"
        class="page-button {{#if isLastPage}}disabled{{/if}}"
      >
        Last »
      </a>
    </div>
  </div>

  {{#if hasRows}}
    <table>
      <thead>
        <tr>
          <th>trans_id</th>
          <th>account_id</th>
          <th>newdate</th>
          <th>type</th>
          <th>amount</th>
          <th>balance</th>
          <th>last_updated_by_node</th>
          <th>version</th>
        </tr>
      </thead>
      <tbody>
        {{#each rows}}
          <tr>
            <td>{{trans_id}}</td>
            <td>{{account_id}}</td>
            <td>{{newdateFormatted}}</td>
            <td>{{type}}</td>
            <td>{{amount}}</td>
            <td>{{balance}}</td>
            <td>{{last_updated_by_node}}</td>
            <td>{{version}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{else}}
    <p><em>No rows found on this node.</em></p>
  {{/if}}
</section>

{{> footer}}
