<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Distributed DB Controller</title>
  <style>
    body { font-family: Arial; padding: 20px; max-width: 600px; margin: auto; }
    input, select, button { width: 100%; padding: 10px; margin: 5px 0; }
    pre { background: #eee; padding: 10px; }
  </style>
</head>
<body>

<h2>Distributed DB Transaction Controller</h2>

<label>Choose Node</label>
<select id="node">
  <option value="10.2.14.10:3001">Node1</option>
  <option value="10.2.14.11:3002">Node2</option>
  <option value="10.2.14.12:3003">Node3</option>
</select>

<label>TXID</label>
<input id="txid" placeholder="tx123">

<label>Isolation Level</label>
<select id="isolation">
  <option value="READ COMMITTED">READ COMMITTED</option>
  <option value="READ UNCOMMITTED">READ UNCOMMITTED</option>
  <option value="REPEATABLE READ">REPEATABLE READ</option>
  <option value="SERIALIZABLE">SERIALIZABLE</option>
</select>

<button onclick="startTx()">Start Transaction</button>

<hr>

<h3>Read</h3>
<input id="read_id" placeholder="trans_id">
<button onclick="readTx()">Read</button>

<h3>Write</h3>
<input id="write_id" placeholder="trans_id">
<input id="write_amount" placeholder="amount">
<button onclick="writeTx()">Write</button>

<h3>Commit / Rollback</h3>
<button onclick="commitTx()">Commit</button>
<button onclick="rollbackTx()">Rollback</button>

<h3>Response</h3>
<pre id="output">Waiting...</pre>

<script>
function api(path, body) {
  const node = document.getElementById("node").value;
  return fetch(`http://${node}${path}`, {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify(body)
  }).then(r => r.json());
}

function show(res) {
  document.getElementById("output").textContent = JSON.stringify(res, null, 2);
}

async function startTx() {
  const txid = document.getElementById("txid").value;
  const isolation = document.getElementById("isolation").value;
  show(await api("/api/tx/start", { txid, isolation }));
}

async function readTx() {
  show(await api("/api/tx/read", {
    txid: document.getElementById("txid").value,
    trans_id: document.getElementById("read_id").value
  }));
}

async function writeTx() {
  show(await api("/api/tx/update", {
    txid: document.getElementById("txid").value,
    trans_id: document.getElementById("write_id").value,
    amount: document.getElementById("write_amount").value
  }));
}

async function commitTx() {
  show(await api("/api/tx/commit", {
    txid: document.getElementById("txid").value,
    replications: []  // you can add actual replication data here
  }));
}

async function rollbackTx() {
  show(await api("/api/tx/rollback", {
    txid: document.getElementById("txid").value
  }));
}
</script>

</body>
</html>
