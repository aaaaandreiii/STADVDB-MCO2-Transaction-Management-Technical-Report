<!DOCTYPE html>
<html>
<head>
  <title>Distributed DB - Node 1</title>
</head>
<body>
  <h1>Node 1 Transaction Control</h1>

  <div>
    <h3>Start Transaction</h3>
    <input id="txidStart" placeholder="txid" />
    <select id="isolation">
      <option>READ UNCOMMITTED</option>
      <option selected>READ COMMITTED</option>
      <option>REPEATABLE READ</option>
      <option>SERIALIZABLE</option>
    </select>
    <button onclick="startTX()">Start</button>
    <pre id="startResult"></pre>
  </div>

  <div>
    <h3>Read Transaction</h3>
    <input id="txidRead" placeholder="txid" />
    <input id="transIdRead" placeholder="trans_id" />
    <button onclick="readTX()">Read</button>
    <pre id="readResult"></pre>
  </div>

  <div>
    <h3>Update Transaction</h3>
    <input id="txidUpdate" placeholder="txid" />
    <input id="transIdUpdate" placeholder="trans_id" />
    <input id="amountUpdate" placeholder="new amount" />
    <button onclick="updateTX()">Update</button>
    <pre id="updateResult"></pre>
  </div>

  <div>
    <h3>Commit Transaction</h3>
    <input id="txidCommit" placeholder="txid" />
    <button onclick="commitTX()">Commit</button>
    <pre id="commitResult"></pre>
  </div>

<script>
async function startTX() {
  const txid = document.getElementById('txidStart').value;
  const isolation = document.getElementById('isolation').value;
  const res = await fetch('/api/tx/start', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({txid, isolation})
  });
  document.getElementById('startResult').innerText = JSON.stringify(await res.json(), null, 2);
}

async function readTX() {
  const txid = document.getElementById('txidRead').value;
  const trans_id = document.getElementById('transIdRead').value;
  const res = await fetch('/api/tx/read', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({txid, trans_id})
  });
  document.getElementById('readResult').innerText = JSON.stringify(await res.json(), null, 2);
}

async function updateTX() {
  const txid = document.getElementById('txidUpdate').value;
  const trans_id = document.getElementById('transIdUpdate').value;
  const amount = document.getElementById('amountUpdate').value;
  const res = await fetch('/api/tx/update', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({txid, trans_id, amount})
  });
  document.getElementById('updateResult').innerText = JSON.stringify(await res.json(), null, 2);
}

async function commitTX() {
  const txid = document.getElementById('txidCommit').value;
  const res = await fetch('/api/tx/commit', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({txid})
  });
  document.getElementById('commitResult').innerText = JSON.stringify(await res.json(), null, 2);
}
</script>
</body>
</html>
